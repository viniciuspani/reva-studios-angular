/* =========================================================
   USER DASHBOARD — SCSS LIMPO, SEGURO, NÃO QUEBRA CARDS
   Pis: sidebar tree 100% funcional, CRUD correto, sem overflow
   ========================================================= */

/* === Base layout =================================================== */
.user-dashboard {
  min-height: 100vh;
  background-color: hsl(0, 0%, 98%);
}

.dashboard-container {
  padding: 8rem 1rem 5rem;
  max-width: 90rem;
  margin: 0 auto;
}

.dashboard-header {
  margin-bottom: 2rem;

  h1 {
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: .5rem;
    color: hsl(270,15%,10%);
  }

  p {
    color: hsl(270,15%,40%);
    margin: 0;
  }
}

/* === Estatísticas =================================================== */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(280px,1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;

  ::ng-deep .p-card {
    border-radius: .75rem;
    box-shadow: 0 1px 3px rgba(0,0,0,.07);
  }

  .card-icon {
    height: 3rem; width: 3rem;
    border-radius: 9999px;
    display:flex; align-items:center; justify-content:center;
    background: linear-gradient(45deg,hsl(280,85%,55%),hsl(320,80%,60%));
    margin: 0 auto 1rem;

    i { color:#fff; font-size:1.5rem; }
  }

  h3 { margin:0 0 .25rem; }
}

/* === Main grid ====================================================== */
.main-grid {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 1.5rem;
}

/* ====================================================================
   FOLDERS SIDEBAR — PASTAS
   ==================================================================== */

.folders-card {
  border-radius:.75rem;

  > ::ng-deep .p-card {
    border-radius:.75rem;
    box-shadow:0 1px 6px rgba(0,0,0,.06);
    border:1px solid rgba(124,58,237,.06);
  }

  .folders-header {
    padding:1rem 1.25rem;
    display:flex; align-items:center; justify-content:space-between;
    border-bottom:1px solid rgba(0,0,0,.04);

    h3 { margin:0; font-size:1rem; font-weight:600; }
    .add-folder-btn:hover {
      background:#d946ef !important; color:#fff !important;
    }
  }
}

/* ====================================================================
   P-TREE — ISOLADO! NÃO QUEBRA OUTROS COMPONENTES
   IMPORTANTE: styleClass="folders-tree" deve estar no p-tree no HTML
   ==================================================================== */

.p-tree.folders-tree {
  --p-tree-node-hover-background:#d946ef;
  --p-tree-node-hover-color:#fff;
  --p-tree-node-selected-background:#d946ef;
  --p-tree-node-selected-color:#fff;
  --p-tree-node-icon-color:#fff;
  --p-tree-node-icon-hover-color:#fff;
  --p-tree-node-icon-selected-color:#fff;

  border:none;
  background:transparent;
  padding:.75rem .5rem;
}

/* Evita barra horizontal — SEM esconder os botões */
.p-tree.folders-tree,
.p-tree.folders-tree .p-tree-container,
.p-tree.folders-tree .p-tree-node,
.p-tree.folders-tree .p-tree-node-content {
  max-width:100%;
  overflow-x: clip; /* NÃO usa hidden — clip impede scroll mas mostra conteúdo */
  overflow-y: visible;
}

/* Node content layout */
.p-tree.folders-tree .p-tree-node-content {
  display:flex !important;
  align-items:center !important;
  gap:.5rem !important;
  flex-wrap:nowrap !important;
  min-width:0 !important;
  padding:.65rem .55rem !important;
  border-radius:.5rem !important;
}

/* Toggler e ícone nunca encolhem */
.p-tree.folders-tree .p-tree-node-toggle-button,
.p-tree.folders-tree .p-tree-node-icon {
  flex-shrink:0 !important;
}

/* Template customizado */
.custom-tree-node {
  display:flex !important;
  align-items:center !important;
  justify-content:space-between !important;
  gap:.5rem !important;
  width:100%;
  min-width:0;
  overflow-x:clip; /* necessário para evitar barra horizontal */
  overflow-y:visible;
}

/* Nome da pasta */
.folder-label {
  flex:1 1 auto !important;
  min-width:0 !important;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* ====================================================================
   CRUD — BOTÕES DE AÇÃO
   ==================================================================== */

/* Container das ações */
.p-tree.folders-tree .folder-actions {
  display:flex;
  gap:.4rem;
  flex-shrink:0;
  opacity:0;
  pointer-events:none;
  white-space:nowrap;
  transition:opacity .12s ease;
  align-items:center;
}

/* Botões */
.p-tree.folders-tree .folder-action-btn {
  width:1.75rem !important;
  height:1.75rem !important;
  min-width:1.75rem !important;
  padding:0 !important;
  display:inline-flex !important;
  align-items:center !important;
  justify-content:center !important;
  flex-shrink:0 !important;
}

/* Delete hover */
.p-tree.folders-tree .folder-delete-btn:hover {
  background-color:rgba(239,68,68,.12) !important;
}

/* Mostrar CRUD no hover */
.p-tree.folders-tree .p-tree-node-content:hover .folder-actions {
  opacity:1 !important;
  pointer-events:auto !important;
}

/* Mostrar CRUD quando selecionado */
.p-tree.folders-tree .p-tree-node-content.p-tree-node-selected .folder-actions {
  opacity:1 !important;
  pointer-events:auto !important;
}

/* ====================================================================
   Hover / Selected — cores corretas e ícones brancos
   ==================================================================== */

.p-tree.folders-tree .p-tree-node-content:hover,
.p-tree.folders-tree .p-tree-node-content.p-tree-node-selected {
  background:#d946ef !important;
  color:#fff !important;
  box-shadow:0 2px 6px rgba(217,70,239,.12);
}

.p-tree.folders-tree .p-tree-node-content:hover .p-tree-node-icon,
.p-tree.folders-tree .p-tree-node-content.p-tree-node-selected .p-tree-node-icon,
.p-tree.folders-tree .p-tree-node-content:hover .p-tree-node-toggle-icon,
.p-tree.folders-tree .p-tree-node-content.p-tree-node-selected .p-tree-node-toggle-icon,
.p-tree.folders-tree .p-tree-node-content:hover .p-button-icon,
.p-tree.folders-tree .p-tree-node-content.p-tree-node-selected .p-button-icon {
  color:#fff !important;
  fill:#fff !important;
}

/* ====================================================================
   GALERIA DE FOTOS — NÃO ALTERADO, NÃO AFETADO PELO TREE
   (mantém seu layout original)
   ==================================================================== */

.gallery-section ::ng-deep .p-card {
  border-radius:.75rem;
  box-shadow:0 1px 3px rgba(0,0,0,.1);
}

/* Miniaturas */
.photos-grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(200px,1fr));
  gap:1rem;
}

.photo-card {
  position:relative;
  aspect-ratio:1;
  border-radius:.5rem;
  overflow:hidden;
  background:hsl(270,20%,96%);
}

/* Overlay */
.photo-overlay {
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:.5rem;
  background:rgba(0,0,0,.6);
  opacity:0; transition:.25s;

  .p-button { box-shadow:0 2px 4px rgba(0,0,0,.25); }
}

.photo-card:hover .photo-overlay { opacity:1; }

/* Nome */
.photo-name {
  position:absolute; bottom:0; left:0; right:0;
  padding:.5rem;
  background:rgba(0,0,0,.8);
  color:white;
  font-size:.75rem;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* === Responsivo ==================================================== */
@media (max-width:1024px) {
  .main-grid { grid-template-columns:1fr; }
  .folders-card { max-height:300px; overflow-y:auto; }
}
