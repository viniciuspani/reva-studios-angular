/* FINAL SCSS - substituir todo o arquivo */

/* Palette
   base: #7c3aed
   hover: #d946ef
*/

/* === Base layout === */
.user-dashboard {
  min-height: 100vh;
  background-color: hsl(0,0%,98%);
}

.dashboard-container {
  padding: 8rem 1rem 5rem;
  max-width: 90rem;
  margin: 0 auto;
}

/* Top cards */
.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(280px,1fr));
  gap: 1.5rem;
  margin-bottom: 2rem;

  ::ng-deep .p-card {
    border-radius: .75rem;
    background: #fff;
    padding: 1rem;
    box-shadow: 0 1px 3px rgba(0,0,0,.06);
    border: 1px solid rgba(0,0,0,0.03);
  }

  .card-icon { height:3rem; width:3rem; border-radius:9999px; display:flex; align-items:center; justify-content:center; background: linear-gradient(45deg,#7c3aed,#a78bfa); margin:0 auto 1rem; i{ color:#fff;} }
}

/* Main layout */
.main-grid {
  display:grid;
  grid-template-columns: 280px 1fr;
  gap:1.5rem;
}

/* ===========================
   FOLDERS SIDEBAR (LEFT)
   =========================== */

.folders-card {
  min-width: 277.5px;
  min-height: 110px;
  border-radius: .75rem;
  padding: 0;

  /* style only the p-card inside this folders-card */
  > ::ng-deep .p-card {
    border-radius:.75rem;
    background:#fff;
    box-shadow:0 1px 6px rgba(0,0,0,.06);
    border:1px solid rgba(124,58,237,0.06);
  }

  .folders-header {
    padding: 1rem 1.25rem;
    display:flex;
    align-items:center;
    justify-content:space-between;
    border-bottom:1px solid rgba(0,0,0,0.04);

    h3 { margin:0; font-size:1rem; font-weight:600; color: #222; }
    .add-folder-btn { transition: all .12s; &:hover{ background:#7c3aed!important; color:#fff!important; border-radius:.375rem; } }
  }

  /* tree body padding */
  ::ng-deep .p-card-body { padding: 0.5rem; }
}

/* ===========================
   P-TREE STYLES (SCOPED)
   - p-tree must have styleClass="folders-tree"
   - selectors are prefixed with .folders-card to avoid leakage
   =========================== */

.folders-card .p-tree.folders-tree {
  --p-tree-node-hover-background: #d946ef;
  --p-tree-node-hover-color: #fff;
  --p-tree-node-selected-background: #7c3aed;
  --p-tree-node-selected-color: #fff;
  --p-tree-node-icon-color: #fff;
  --p-tree-node-icon-hover-color: #fff;
  --p-tree-node-icon-selected-color: #fff;

  border:none;
  background:transparent;
  padding:0;
}

/* block-level guards to avoid horizontal scroll and clipping issues */
// .folders-card .p-tree.folders-tree,
// .folders-card .p-tree.folders-tree .p-tree-container,
// .folders-card .p-tree.folders-tree .p-tree-root,
// .folders-card .p-tree.folders-tree .p-tree-node,
// .folders-card .p-tree.folders-tree .p-tree-node-content {
//   max-width: 100%;
//   overflow-x: clip; /* prevents horizontal scrollbar without hiding overlays */
//   overflow-y: visible;
//   box-sizing: border-box;
// }

/* Mantém visibilidade dos ícones sem quebrar layout */
.folders-card .p-tree.folders-tree .p-tree-node {
  overflow: visible !important;
}

.folders-card .p-tree.folders-tree .p-tree-node-content {
  overflow: visible !important;
}

/* node layout */
.folders-card .p-tree.folders-tree .p-tree-node-content {
  display:flex !important;
  align-items:center !important;
  gap:.5rem !important;
  flex-wrap:nowrap !important;
  min-width:0 !important;
  padding:.6rem .5rem !important;
  border-radius:.5rem;
  position:relative; /* so that actions (z-index) are above */
}

/* ensure toggle icon and node icon don't shrink */
.folders-card .p-tree.folders-tree .p-tree-node-toggle-button,
.folders-card .p-tree.folders-tree .p-tree-node-icon {
  flex-shrink:0 !important;
}

/* our template wrapper */
.folders-card .custom-tree-node {
  display:flex !important;
  align-items:center !important;
  justify-content:space-between !important;
  gap:.5rem !important;
  width:100%;
  min-width:0;
  overflow:visible; /* allow actions to show */
}

/* label with ellipsis */
.folders-card .custom-tree-node .folder-label {
  flex:1 1 auto !important;
  min-width:0 !important;
  overflow:hidden !important;
  text-overflow:ellipsis !important;
  white-space:nowrap !important;
  padding-left:.25rem;
}

/* actions container */
.folders-card .p-tree.folders-tree .folder-actions {
  display:flex;
  gap:.35rem;
  flex-shrink:0;
  white-space:nowrap;
  opacity:0;
  pointer-events:none;
  transition: opacity .12s ease;
  align-items:center;
  z-index: 20; /* ensure above background */
}

/* action buttons sizing - target p-button rendered elements */
.folders-card .p-tree.folders-tree .folder-action-btn,
.folders-card .p-tree.folders-tree .folder-action-btn.p-button {
  width:1.75rem !important;
  height:1.75rem !important;
  min-width:1.75rem !important;
  padding:0 !important;
  display:inline-flex !important;
  align-items:center !important;
  justify-content:center !important;
  flex-shrink:0 !important;
}

/* make sure the icon inside p-button is visible and white on hover/select */
.folders-card .p-tree.folders-tree .p-button.folder-action-btn .p-button-icon,
.folders-card .p-tree.folders-tree .p-button.folder-action-btn .pi {
  color: inherit;
}

/* delete button hover color */
.folders-card .p-tree.folders-tree .folder-delete-btn:hover,
.folders-card .p-tree.folders-tree .p-button.folder-delete-btn:hover {
  background-color: rgba(239,68,68,0.12) !important;
}

/* reveal actions for all levels: node hover or selected
   include both p-highlight and p-tree-node-selected to be safe across versions */
.folders-card .p-tree.folders-tree li.p-tree-node .p-tree-node-content:hover .folder-actions,
.folders-card .p-tree.folders-tree li.p-tree-node .p-tree-node-content.p-highlight .folder-actions,
.folders-card .p-tree.folders-tree li.p-tree-node .p-tree-node-content.p-tree-node-selected .folder-actions,
.folders-card .p-tree.folders-tree .p-tree-node-children li.p-tree-node .p-tree-node-content:hover .folder-actions,
.folders-card .p-tree.folders-tree .p-tree-node-children li.p-tree-node .p-tree-node-content.p-highlight .folder-actions,
.folders-card .p-tree.folders-tree .p-tree-node-children li.p-tree-node .p-tree-node-content.p-tree-node-selected .folder-actions {
  opacity:1 !important;
  pointer-events:auto !important;
}

/* hover & selected bg color */
.folders-card .p-tree.folders-tree .p-tree-node-content:hover {
  background: #d946ef !important;
  color: #fff !important;
}

.folders-card .p-tree.folders-tree .p-tree-node-content.p-highlight,
.folders-card .p-tree.folders-tree .p-tree-node-content.p-tree-node-selected {
  background: #7c3aed !important;
  color: #fff !important;
  box-shadow: 0 2px 6px rgba(124,58,237,0.12);
}

/* ensure icons and p-button icons turn white when hover/selected */
.folders-card .p-tree.folders-tree .p-tree-node-content:hover .p-tree-node-icon,
.folders-card .p-tree.folders-tree .p-tree-node-content.p-highlight .p-tree-node-icon,
.folders-card .p-tree.folders-tree .p-tree-node-content.p-tree-node-selected .p-tree-node-icon,
.folders-card .p-tree.folders-tree .p-tree-node-content:hover .p-button-icon,
.folders-card .p-tree.folders-tree .p-tree-node-content.p-highlight .p-button-icon,
.folders-card .p-tree.folders-tree .p-tree-node-content.p-tree-node-selected .p-button-icon {
  color:#fff !important;
  fill:#fff !important;
}

/* children indentation - allow overflow for action buttons */
.folders-card .p-tree.folders-tree .p-tree-node-children {
  padding-left: 1rem;
  overflow: visible !important;
}

/* Ensure tree container allows overflow for buttons */
.folders-card .p-tree.folders-tree .p-tree-container,
.folders-card .p-tree.folders-tree .p-tree-root {
  overflow: visible !important;
}

/* Fix node content width to prevent button clipping */
.folders-card .p-tree.folders-tree .p-tree-node-content {
  min-width: fit-content !important;
}

/* ===========================
   GALLERY SECTION LAYOUT
   =========================== */
.gallery-section {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}

/* ===========================
   UPLOAD CARD (center)
   - scoped with .upload-card wrapper in HTML
   =========================== */

/* style the p-card inside upload-card */
.upload-card ::ng-deep .p-card {
  border-radius: .75rem;
  background: #fff;
  box-shadow: 0 1px 6px rgba(0,0,0,.06);
  border: 1px solid rgba(124,58,237,0.03);
}

.upload-card ::ng-deep .p-card-body {
  padding: 1.25rem 1.5rem;
}

/* upload header layout */
.upload-card .upload-header {
  padding: 1.25rem 1.5rem 0.5rem;

  h3 {
    display: flex;
    align-items: center;
    margin: 0 0 0.25rem 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: #222;
  }

  p {
    margin: 0;
    font-size: 0.9rem;
    color: #666;
  }

  i.pi {
    color: #7c3aed;
    margin-right: 0.5rem;
    font-size: 1.1rem;
  }
}

/* file path info inside upload */
.file-path-info .p-card {
  border-radius:.5rem;
  border:1px solid rgba(124,58,237,0.06);
  box-shadow:0 1px 6px rgba(0,0,0,0.04);
  background:#fff;
}

/* ===========================
   GALLERY CARD
   - scoped with .gallery-card wrapper in HTML
   =========================== */

.gallery-card ::ng-deep .p-card {
  border-radius: .75rem;
  background: #fff;
  box-shadow: 0 1px 6px rgba(0,0,0,.06);
  border: 1px solid rgba(124,58,237,0.03);
}

.gallery-card ::ng-deep .p-card-body {
  padding: 1.25rem 1.5rem;
}

/* gallery header layout */
.gallery-card .gallery-header {
  padding: 1.25rem 1.5rem 0.5rem;

  h3 {
    display: flex;
    align-items: center;
    margin: 0 0 0.25rem 0;
    font-size: 1.1rem;
    font-weight: 600;
    color: #222;
  }

  p {
    margin: 0;
    font-size: 0.9rem;
    color: #666;
  }

  i.pi {
    color: #7c3aed;
    margin-right: 0.5rem;
    font-size: 1.1rem;
  }
}

/* photos grid and photo-card */
.photos-grid { display:grid; grid-template-columns: repeat(auto-fill,minmax(200px,1fr)); gap:1rem; }
.photo-card { position:relative; aspect-ratio:1; border-radius:.5rem; overflow:hidden; background:hsl(270,20%,96%); box-shadow:0 1px 3px rgba(0,0,0,.03); }
.photo-card img{width:100%;height:100%;object-fit:cover;display:block;}

/* overlay actions - order: download, move, delete */
.photo-overlay {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: space-evenly;
  padding: 0 1rem;
  background: rgba(0,0,0,0.55);
  opacity: 0;
  transition: opacity .18s ease;
  z-index: 10;
}

.photo-card:hover .photo-overlay {
  opacity: 1;
}

/* Base button styles in overlay */
.photo-overlay ::ng-deep .p-button {
  width: 2.5rem !important;
  height: 2.5rem !important;
  border-radius: 50% !important;
  border: none !important;
  transition: transform 0.15s ease, box-shadow 0.15s ease;

  &:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  }

  .pi {
    font-size: 1rem;
  }
}

/* Download button - purple/violet */
.photo-overlay ::ng-deep .btn-download.p-button {
  background: linear-gradient(135deg, #7c3aed, #a78bfa) !important;
  color: #fff !important;
}

/* Move button - gray */
.photo-overlay ::ng-deep .btn-move.p-button {
  background: linear-gradient(135deg, #6b7280, #9ca3af) !important;
  color: #fff !important;
}

/* Delete button - red */
.photo-overlay ::ng-deep .btn-delete.p-button {
  background: linear-gradient(135deg, #dc2626, #f87171) !important;
  color: #fff !important;
}

/* Move menu popup styles - PrimeNG v20 */
::ng-deep .p-menu {
  .p-menu-list {
    padding: 0.5rem 0;
  }

  .p-menuitem {
    /* PrimeNG v20 uses p-menuitem-content instead of p-menuitem-link */
    .p-menuitem-content {
      padding: 0.65rem 1rem;
      cursor: pointer !important;
      transition: background-color 0.15s ease;
      border-radius: 0;

      &:hover {
        background-color: #d946ef !important;

        .p-menuitem-link {
          color: #fff !important;
        }

        .p-menuitem-icon,
        .p-menuitem-text {
          color: #fff !important;
        }
      }
    }

    .p-menuitem-link {
      padding: 0;
      background: transparent !important;

      &:hover {
        background: transparent !important;
      }
    }

    .p-menuitem-icon {
      margin-right: 0.5rem;
      color: #6b7280;
    }

    .p-menuitem-text {
      color: #333;
    }
  }

  /* Focus state */
  .p-menuitem.p-focus > .p-menuitem-content {
    background-color: #f3e8ff !important;
  }

  .p-menuitem.p-focus > .p-menuitem-content:hover {
    background-color: #d946ef !important;
  }
}

/* name bar */
.photo-name { position:absolute; left:0; right:0; bottom:0; padding:.5rem; background: rgba(0,0,0,.8); color:#fff; font-size:.75rem; overflow:hidden; white-space:nowrap; text-overflow:ellipsis; }

/* ===========================
   Responsive tweaks
   =========================== */
@media (max-width:1024px) {
  .main-grid { grid-template-columns:1fr; }
  .folders-card { max-height:none; }
}
@media (max-width:768px) {
  .stats-grid { grid-template-columns:1fr; }
  .photos-grid { grid-template-columns: repeat(auto-fill,minmax(150px,1fr)); }
}
